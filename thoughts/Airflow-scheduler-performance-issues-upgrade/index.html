<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Context We currently host an Airflow on EKS, configured to run jobs on an EKS cluster with the KubernetesExecutor.
For a year now, we&rsquo;ve been stuck with Airflow version 2."><title>Airflow Scheduler Performance issues upgrade</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Airflow Scheduler Performance issues upgrade"><meta property="og:image" content="https://digital-garden.erdrix.konpyutaika.com/glossary-feature.jpeg"><meta property="og:type" content="website"><meta property="og:url" content="https://digital-garden.erdrix.konpyutaika.com/thoughts/Airflow-scheduler-performance-issues-upgrade/"><meta property="og:width" content="1119"><meta property="og:height" content="630"><meta name=twitter:card content="summary"><meta name=twitter:site content="@alexandreguitt"><meta name=twitter:title content="Airflow Scheduler Performance issues upgrade"><meta name=twitter:description content="Context We currently host an Airflow on EKS, configured to run jobs on an EKS cluster with the KubernetesExecutor.
For a year now, we&rsquo;ve been stuck with Airflow version 2."><meta name=twitter:image content="https://digital-garden.erdrix.konpyutaika.com/glossary-feature.jpeg"><link rel="shortcut icon" type=image/png href=https://digital-garden.erdrix.konpyutaika.com//icon.png><link href=https://digital-garden.erdrix.konpyutaika.com/styles.b262430ef2eef00064c0c52a75f1c8dc.min.css rel=stylesheet><link href=https://digital-garden.erdrix.konpyutaika.com/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://digital-garden.erdrix.konpyutaika.com/js/darkmode.6542a1f168a1bef32cbea9e19276922d.min.js></script>
<script src=https://digital-garden.erdrix.konpyutaika.com/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://digital-garden.erdrix.konpyutaika.com/js/popover.53ad9a087e3feeaaa12b63bfd02d923b.min.js></script>
<script src=https://digital-garden.erdrix.konpyutaika.com/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://digital-garden.erdrix.konpyutaika.com/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://digital-garden.erdrix.konpyutaika.com/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://digital-garden.erdrix.konpyutaika.com/",fetchData=Promise.all([fetch("https://digital-garden.erdrix.konpyutaika.com/indices/linkIndex.a3fa0928648a6aa75045efd2909496f8.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://digital-garden.erdrix.konpyutaika.com/indices/contentIndex.90202bb6e3d06b95d02ebbf5ae640c3e.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://digital-garden.erdrix.konpyutaika.com",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://digital-garden.erdrix.konpyutaika.com",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:2,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:8,scale:1.5})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{"â€™":"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/digital-garden.erdrix.konpyutaika.com\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-156258629-2"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-156258629-2")</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://digital-garden.erdrix.konpyutaika.com/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><article><header><h1 id=page-title><a href=https://digital-garden.erdrix.konpyutaika.com/>Alexandre Guitton Digital Garden ðŸª´</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><a href=/tags><div class=darkmode><input class=toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle-bla tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 490 490" style="enable-background:new 0 0 35 35"><title>All Tags</title><path d="M64.333 490h58.401l33.878-137.69h122.259L245.39 490h58.401l33.878-137.69h119.92v-48.162h-108.24l29.2-117.324h79.04v-48.162H390.23L424.108.0H365.31l-33.878 138.661H208.79L242.668.0h-58.415l-33.864 138.661H32.411v48.162h106.298l-28.818 117.324h-77.48v48.162h65.8L64.333 490zM197.11 186.824h122.642l-29.2 117.324H168.292L197.11 186.824z"/></svg></label><label id=toggle-label-dark for=darkmode-togglead tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 490 490" style="enable-background:new 0 0 35 35"><title>All Tags</title><path d="M64.333 490h58.401l33.878-137.69h122.259L245.39 490h58.401l33.878-137.69h119.92v-48.162h-108.24l29.2-117.324h79.04v-48.162H390.23L424.108.0H365.31l-33.878 138.661H208.79L242.668.0h-58.415l-33.864 138.661H32.411v48.162h106.298l-28.818 117.324h-77.48v48.162h65.8L64.333 490zM197.11 186.824h122.642l-29.2 117.324H168.292L197.11 186.824z"/></svg></label></div></a><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><h1>Airflow Scheduler Performance issues upgrade</h1><p class=meta>Last updated
Unknown
- <a href=https://github.com/erdrix/digital-garden-git/tree/main/thoughts/Airflow%20scheduler%20performance%20issues%20upgrade.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://digital-garden.erdrix.konpyutaika.com/tags/sapling/>Sapling</a></li><li><a href=https://digital-garden.erdrix.konpyutaika.com/tags/log/>Log</a></li><li><a href=https://digital-garden.erdrix.konpyutaika.com/tags/airflow/>Airflow</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#context>Context</a></li><li><a href=#objective>Objective</a></li><li><a href=#realisation>Realisation</a><ol><li><a href=#version-222>Version 2.2.2</a></li><li><a href=#version-234>Version 2.3.4</a></li><li><a href=#version-243>Version 2.4.3</a></li><li><a href=#version-263>Version 2.6.3</a></li></ol></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></details></aside><a href=#context><h2 id=context><span class=hanchor arialabel=Anchor># </span>Context</h2></a><p>We currently host an Airflow on EKS, configured to run jobs on an <code>EKS cluster</code> with the <code>KubernetesExecutor</code>.</p><p>For a year now, we&rsquo;ve been stuck with Airflow version <code>2.2.2</code>. We&rsquo;ve tried several times to upgrade our instance to a different version without success (i.e. without regression on some of our DAGs).</p><p>It&rsquo;s important to note that our use of Airflow may partly explain why we can&rsquo;t avoid regression when updating.
We have a single Airflow instance using <code>KuberneteExecutor</code> that hosts over <strong>150 DAGs</strong>, from a <em>light DAG (2 or 3 tasks) with a very high frequency (&lt;5min)</em> to a <em>very heavy DAG (> 3000 tasks) run on a daily basis</em>.
This use leads to a certain complexity in Airflow configuration:</p><ul><li>It&rsquo;s difficult to fine-tune the scheduler to our Airflow DAGs, as it has to meet opposing needs (e.g., increase throughput increase performance for light DAGs, but slow down large DAGs).</li><li>If an Airflow has an impact on one of the DAGs (technical or performance problem), this means we&rsquo;re stuck with all the DAGs.</li></ul><a href=#objective><h2 id=objective><span class=hanchor arialabel=Anchor># </span>Objective</h2></a><p>The aim was to try to update Airflow in an isolated environment, with the aim of reproducing the previous update attempts with the associated problems, and to check whether in one of the latest versions (
<a href=https://airflow.apache.org/docs/apache-airflow/stable/release_notes.html#airflow-2-6-3-2023-07-10 rel=noopener>Airflow 2.6.3</a>) we could solve these problems.
There are two challenges to attempting a new update in production:</p><ol><li>Succeeding in reproducing the problems encountered during updates in an isolated environment.</li><li>Solving these problems in a way that gives us high confidence of reproducing them in the production environment (for example, if we manage to solve the problems by fine-tuning the scheduler to make our large DAGs work, but can&rsquo;t guarantee that the lightweight DAGs will work, that&rsquo;s not considered safe).</li></ol><a href=#realisation><h2 id=realisation><span class=hanchor arialabel=Anchor># </span>Realisation</h2></a><a href=#version-222><h3 id=version-222><span class=hanchor arialabel=Anchor># </span>Version 2.2.2</h3></a><p>This is our current version, and we&rsquo;re using it as a reference in terms of execution, which we want to be as close to as possible. As we already know (from our previous attempts) which types of DAGs are affected by the problems and what those problems are, we only activate 4 DAGs:</p><ul><li>2 high-frequency DAGs,</li><li>1 large DAG</li><li>and 1 standard DAG)
to define the values for our reference.</li></ul><p>Here&rsquo;s some of the information we&rsquo;ve followed when updating:</p><ul><li><strong>For high-frequency DAGs:</strong> in 2.2.2 the behavior is bad, because if you don&rsquo;t set catchup to <code>True</code> the scheduler will skip executions, and if you do, it will accumulate delays.</li><li>For a Big DAG:** in a staging environment (with little data), execution should take <strong>~25 min</strong>.</li></ul><a href=#version-234><h3 id=version-234><span class=hanchor arialabel=Anchor># </span>Version 2.3.4</h3></a><p>To upgrade in
<a href=https://airflow.apache.org/docs/apache-airflow/stable/release_notes.html#airflow-2-3-4-2022-08-23 rel=noopener>Airflow 2.3.4</a> , we simply upgrade some dependencies:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>poetry</span><span class=p>.</span><span class=nx>dependencies</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>python</span> <span class=p>=</span> <span class=s2>&#34;3.9.*&#34;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=nx>PyYAML</span> <span class=p>=</span> <span class=s2>&#34;6.*&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>SQLAlchemy</span> <span class=p>=</span> <span class=s2>&#34;1.4.*&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>Werkzeug</span> <span class=p>=</span> <span class=s2>&#34;2.*&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>apache-airflow</span> <span class=p>=</span> <span class=s2>&#34;2.3.4&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>cattrs</span> <span class=p>=</span> <span class=s2>&#34;23.*&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>python-slugify</span> <span class=p>=</span> <span class=s2>&#34;8.*&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>rich</span> <span class=p>=</span> <span class=s2>&#34;13.*&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>clickhouse_driver</span><span class=p>=</span><span class=s2>&#34;0.2.6&#34;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></td></tr></table></div></div><p>Once the new version had been deployed, we tried to reproduce the problem we encountered on our first attempt, namely that for high-frequency DAGs, the scheduler [doesn&rsquo;t succeed in scheduling queued task] (
<a href=https://github.com/apache/airflow/issues/26394 rel=noopener>https://github.com/apache/airflow/issues/26394</a>) caused the DAG to stall completely.</p><p>So we simply ran our 2 DAGs, and encountered exactly the same problem.</p><p>As I&rsquo;ve already encountered this problem in another context, and it was solved by simply removing all external dependencies from the DagBag load, I tested it by removing all references to Credstash and Airflow DB (<code>Variable.get</code>) that were outside the task execution. But this doesn&rsquo;t seem to solve the problem.</p><a href=#version-243><h3 id=version-243><span class=hanchor arialabel=Anchor># </span>Version 2.4.3</h3></a><p>To upgrade in
<a href=https://airflow.apache.org/docs/apache-airflow/stable/release_notes.html#airflow-2-4-3-2022-11-14 rel=noopener>Airflow 2.4.3</a>, once again a simple upgrade of the python package and dependencies was enough:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[tool.poetry.dependencies]
</span></span><span class=line><span class=cl>python = &#34;3.9.*&#34;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>apache-airflow = &#34;2.4.3&#34;
</span></span><span class=line><span class=cl>attrs = &#34;23.1.*&#34;
</span></span><span class=line><span class=cl>boto3 = &#34;1.28.*&#34;
</span></span></code></pre></td></tr></table></div></div><p>With this, I ran exactly the same 2 DAGs as in the previous version, but this time no DagRun froze, everything worked fine, as we had observed in the previous update attempt.</p><p>So I moved on to the problem we had in this version, namely the significant latency introduced in the DAG with many tasks, without change. I simply took the existing DAG and removed all external DAG dependencies (sensors) and ran it directly.</p><p>Execution took over <strong>55 minutes</strong>, twice as long as the reference time in <code>2.2.2</code> (<strong>~25 minutes</strong>), and this without any other task running on Airflow, and with one task ending quickly, since there was no more data to calculate (which should be easier for the scheduler to handle than in production).</p><a href=#version-263><h3 id=version-263><span class=hanchor arialabel=Anchor># </span>Version 2.6.3</h3></a><p>To update [Airflow 2.6.3] (
<a href=https://airflow.apache.org/docs/apache-airflow/stable/release_notes.html#airflow-2-6-3-2023-07-10%29 rel=noopener>https://airflow.apache.org/docs/apache-airflow/stable/release_notes.html#airflow-2-6-3-2023-07-10)</a>, once again a simple update of the python package and dependencies was enough (the <code>KubernetesExecutor</code> requires a newer version of the <code>kubernetes</code> library, so we need to update the provider) :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[tool.poetry.dependencies]
</span></span><span class=line><span class=cl>python = &#34;3.9.*&#34;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>apache-airflow = &#34;2.6.3&#34;
</span></span><span class=line><span class=cl>apache-airflow-providers-cncf-kubernetes = &#34;7.6.0&#34;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>[tool.poetry.dev-dependencies]
</span></span><span class=line><span class=cl>jsonschema = &#34;4.19.*&#34;
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p>And when we ran our Big DAG again, it had exactly the same execution time as in version <code>2.4.3</code>.
So we tried playing around with the scheduler, to see if we could influence its behavior to improve execution time:</p><ul><li>Test with several schedulers instead of just one (2, 3 and 4)</li><li>Tuning the scheduler with 5 schedulers, based on [what should be more efficient for a DAG with many tasks] (
<a href=https://airflow.apache.org/docs/apache-airflow/stable/administration-and-deployment/scheduler.html#scheduler-configuration-options%29 rel=noopener>https://airflow.apache.org/docs/apache-airflow/stable/administration-and-deployment/scheduler.html#scheduler-configuration-options)</a>:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>AIRFLOW__SCHEDULER__MAX_DAGRUNS_PER_LOOP_TO_SCHEDULE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>AIRFLOW__SCHEDULER__MAX_DAGRUNS_TO_CREATE_PER_LOOP</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ul><p>The result remains exactly the same.</p><a href=#conclusion><h2 id=conclusion><span class=hanchor arialabel=Anchor># </span>Conclusion</h2></a><p>In our current state, we are unable to correct the latency introduced in DAGs with many tasks in version <code>2.4.3</code> even if the problem with high-frequency DAGs introduced in <code>2.3.4</code> is solved.</p><p>This means that due to the heterogeneity of our DAGs and their large number, we are unable to precisely identify the root cause, fine-tune or partially update our Airflow to the version that suits each of them.</p><p>If we were decentralized, we could imagine having an Airflow <code>2.3.4</code> for our big DAGs and <code>2.6.3</code> for all the others. But this is too complex to implement with Airflow (especially to manage dependencies between DAGs).</p><hr><div class=page-end id=footer><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://digital-garden.erdrix.konpyutaika.com/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><ul><li><a href=https://digital-garden.erdrix.konpyutaika.com/>Home</a></li><li><a href=https://twitter.com/AlexandreGuitt>Twitter</a></li><li><a href=https://github.com/konpyutaika>Github</a></li></ul></footer></div></article><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div></div></body></html>